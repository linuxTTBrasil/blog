<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

 <title>Linux TTB</title>
 <link href="https://linuxttbrasil.github.io/atom.xml" rel="self"/>
 <link href="https://linuxttbrasil.github.io/"/>
 <updated>2023-10-03T17:35:09-03:00</updated>
 <id>https://linuxttbrasil.github.io</id>
 <author>
   <name>Thiago Baldino Moreira</name>
   <email>thiagobaldino5@gmail.com</email>
 </author>

 
 <entry>
   <title>NSSM - Parte 1 - Instalação e primeiro serviço</title>
   <link href="https://linuxttbrasil.github.io/2023/09/02/NSSM-Parte1-instalac-a-o-e-primeiro-servic-o.html"/>
   <updated>2023-09-02T00:00:00-03:00</updated>
   <id>https://linuxttbrasil.github.io/2023/09/02/NSSM-Parte1-instalação-e- primeiro -serviço</id>
   <content type="html">&lt;h2 id=&quot;introdução&quot;&gt;Introdução&lt;/h2&gt;

&lt;p&gt;Ao utilizar servidores, inevitavelmente você irá ter que lidar com serviços. Serviços são uma forma de executar um &lt;strong&gt;&lt;em&gt;script&lt;/em&gt;&lt;/strong&gt; ou aplicação em segundo plano (&lt;strong&gt;&lt;em&gt;background&lt;/em&gt;&lt;/strong&gt;). No universo de servidores Linux o &lt;strong&gt;&lt;em&gt;systemd&lt;/em&gt;&lt;/strong&gt; [1] é comumente usado para esse propósito. No Windows Server, as coisas são um pouco mais complicadas. O sistema Windows traz consigo uma aplicação chamada &lt;strong&gt;&lt;em&gt;sc.exe&lt;/em&gt;&lt;/strong&gt; ou &lt;strong&gt;&lt;em&gt;sc&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;O SDK do Windows contém uma ferramenta de linha de comando, Sc.exe, que pode ser utilizada para controlar um serviço. Seus comandos correspondem à funções providas pelo SCM.&lt;/p&gt;

  &lt;p&gt;– &lt;cite&gt;Microsoft documentation&lt;/cite&gt; [2]&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;O &lt;strong&gt;&lt;em&gt;sc&lt;/em&gt;&lt;/strong&gt; permite criar serviços a partir de arquivos &lt;strong&gt;&lt;em&gt;.exe&lt;/em&gt;&lt;/strong&gt; integrando-se bem ao sistema. As vantagens de utilizar o &lt;strong&gt;&lt;em&gt;sc&lt;/em&gt;&lt;/strong&gt; incluem sua natureza nativa, forte integração com o sistema e uma boa documentação. Entretanto, existe uma limitação: o arquivo precisa ser &lt;strong&gt;&lt;em&gt;.exe&lt;/em&gt;&lt;/strong&gt; para ser executado pelo serviço. Para contornar essa limitação, teríamos que criar um &lt;strong&gt;&lt;em&gt;wrapper&lt;/em&gt;&lt;/strong&gt; ou encapsulador utilizando &lt;strong&gt;&lt;em&gt;C#&lt;/em&gt;&lt;/strong&gt;, por exemplo. Este encapsulador, que deve ser registrado como serviço, é um arquivo &lt;strong&gt;&lt;em&gt;.exe&lt;/em&gt;&lt;/strong&gt; que executa o &lt;strong&gt;&lt;em&gt;script&lt;/em&gt;&lt;/strong&gt; desejado. Esse formato de criação de serviços pode não ser muito prático, principalmente para usuários mais acostumados com Linux.&lt;/p&gt;

&lt;p&gt;Em contrapartida, graças ao &lt;strong&gt;&lt;em&gt;systemd&lt;/em&gt;&lt;/strong&gt;, executar um script como serviço em um ambiente Linux é mais simples para usuários com experiência no sistema. Para facilitar a vida de alguns sysadmins (como eu), existem ferramentas que permitem que a criação de serviços no Windows Server seja próxima ao que existe no Linux. Uma dessas ferramentas é o &lt;strong&gt;&lt;em&gt;NSSM&lt;/em&gt;&lt;/strong&gt; (Non-Sucking Service Manager).&lt;/p&gt;

&lt;h2 id=&quot;instalação&quot;&gt;Instalação&lt;/h2&gt;

&lt;p&gt;A instalação pode ser realizada atravês de duas formas:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Chocolatey&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Download Direto do Site.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;instalação-via-chocolatey-recomendado&quot;&gt;Instalação via Chocolatey (Recomendado)&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Chocolatey&lt;/em&gt;&lt;/strong&gt; é um gerenciador de pacotes. Um gerenciador de pacotes é um conjunto de ferramentas que permitem a automatização da instalação de aplicações. Com um gerenciador de pacotes as aplicações são instaladas através de um terminal, como o &lt;strong&gt;&lt;em&gt;powershell&lt;/em&gt;&lt;/strong&gt; por exemplo.&lt;/p&gt;

&lt;p&gt;Para instalar o &lt;strong&gt;&lt;em&gt;NSSM&lt;/em&gt;&lt;/strong&gt; através do &lt;strong&gt;&lt;em&gt;Chocolatey&lt;/em&gt;&lt;/strong&gt; é necessário instalá-lo. Isso pode ser realizado executando o comando abaixo no powershell que deve ser aberto com permissões de administrador [4].&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;Set-ExecutionPolicy&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Bypass&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Scope&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Process&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Force&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;System.Net.ServicePointManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SecurityProtocol&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;System.Net.ServicePointManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]::&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SecurityProtocol&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-bor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;3072&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iex&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;New-Object&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;System.Net.WebClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DownloadString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'https://community.chocolatey.org/install.ps1'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Após realizar a instalação feche o powershell, abra novamente e execute o comando para instalar o &lt;strong&gt;&lt;em&gt;NSSM&lt;/em&gt;&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;choco&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nssm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Será perguntado se tem certeza que quer instalar. Digite &lt;strong&gt;&lt;em&gt;y&lt;/em&gt;&lt;/strong&gt; e pressione &lt;strong&gt;&lt;em&gt;enter&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;

&lt;h3 id=&quot;instalação-via-download-direto-do-site&quot;&gt;Instalação via Download Direto do Site&lt;/h3&gt;

&lt;p&gt;Para realizar a instalação pelo download é necessário acessar o &lt;a href=&quot;https://nssm.cc/download&quot;&gt;site&lt;/a&gt; do nssm. O link está presente na seção &lt;strong&gt;&lt;em&gt;Latest release&lt;/em&gt;&lt;/strong&gt;. O download será um arquivo &lt;strong&gt;&lt;em&gt;.zip&lt;/em&gt;&lt;/strong&gt;. Extraia esse arquivo utilizando qualquer aplicação de descompactação de sua preferência, como WinRAR ou 7-Zip. Navegue até a pasta &lt;strong&gt;&lt;em&gt;win64&lt;/em&gt;&lt;/strong&gt; dentro da pasta que foi descompactada. O &lt;strong&gt;&lt;em&gt;nssm&lt;/em&gt;&lt;/strong&gt; deve ser executado via terminal, portanto, copie o caminho da pasta &lt;strong&gt;&lt;em&gt;win64&lt;/em&gt;&lt;/strong&gt; do explorer, abra uma nova janela do powershell e digite o seguinte comando alterando o [caminho_copiado] para o caominho que você copiou do explorer:&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;caminho_copiado&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No meu caso ficou:&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;cd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\Users\thiagobaldino\Downloads\nssm-2.24\nssm-2.24\win64&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Com isso o &lt;strong&gt;&lt;em&gt;NSSM&lt;/em&gt;&lt;/strong&gt; está, teoricamente, instalado. Porém, sempre que você quiser executa-lo, terá que navegar manualmente até a pasta descompactada. Para poder executar o comando sem precisar navegar até a pasta deve-se adiciona-la ao &lt;a href=&quot;https://en.wikipedia.org/wiki/PATH_(variable)&quot;&gt;&lt;strong&gt;&lt;em&gt;PATH&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt; . &lt;strong&gt;&lt;em&gt;PATH&lt;/em&gt;&lt;/strong&gt; é uma variável que o sistema usa para buscar os binários de programas para executar. Ele possui diversos caminhos e, quando você executa algum comando no terminal, o sistema busca por algum binário para esse comando nos caminhos registrados no &lt;strong&gt;&lt;em&gt;PATH&lt;/em&gt;&lt;/strong&gt; [5]. Adicionar uma pasta ao &lt;strong&gt;&lt;em&gt;PATH&lt;/em&gt;&lt;/strong&gt; pode ser feito dessa maneira: &lt;a href=&quot;https://www.architectryan.com/2018/03/17/add-to-the-path-on-windows-10/&quot;&gt;Como adicionar uma pasta ao &lt;strong&gt;&lt;em&gt;PATH&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt; [6].&lt;/p&gt;

&lt;h2 id=&quot;criação-de-um-novo-serviço&quot;&gt;Criação de um novo serviço&lt;/h2&gt;

&lt;p&gt;A utilização, para a criação de um novo serviço, do &lt;strong&gt;&lt;em&gt;NSSM&lt;/em&gt;&lt;/strong&gt; pode ser através de uma interface gráfica ou através de comandos no terminal. Ambas serão demonstradas mais a frente. Porém, para iniciar a interface gráfica é necessária a execução do comando no terminal.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2023-09-21-criando_servicos_com_nssm/nssm_gui.png&quot; alt=&quot;nssm_gui.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Interface gráfica&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Pela imagem acima, pode-se observar que eu precisei executar o seguinte comando no powershell para que a interface gráfica fosse aberta.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;nssm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;O &lt;em&gt;&lt;strong&gt;NSSM&lt;/strong&gt;&lt;/em&gt; permite a criação somente através dos comandos no terminal.&lt;/p&gt;

&lt;h3 id=&quot;preparações&quot;&gt;Preparações&lt;/h3&gt;

&lt;p&gt;Nós iremos realizar a instalação de um serviço que executa um simples servidor web excrito utilizando &lt;strong&gt;&lt;em&gt;NodeJS&lt;/em&gt;&lt;/strong&gt;. Para que o script possa executado, é necessário a instalação do NodeJS. Caso você ainda não tenha, ele pode ser instalado utilizando o chocolatey através do comando [7]:&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;choco&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nodejs.install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Copie o código abaixo e salve em um arquivo com o nome de &lt;strong&gt;&lt;em&gt;index.js&lt;/em&gt;&lt;/strong&gt; [8].&lt;/p&gt;

&lt;div class=&quot;language-javascript highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;localhost&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;port&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;requestListener&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;writeHead&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;My first server!&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;server&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;createServer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;requestListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`Server is running on http://&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;port&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;instalação-de-um-serviço-utilizando-somente-o-terminal&quot;&gt;Instalação de um serviço utilizando somente o terminal&lt;/h3&gt;

&lt;p&gt;Essa forma de criação é recomendada quando uma interface gráfica não está disponível. Um exemplo é a criação de um serviço utilizando &lt;strong&gt;&lt;em&gt;SSH&lt;/em&gt;&lt;/strong&gt; ou acesso remoto somente via terminal.&lt;/p&gt;

&lt;p&gt;Para criar um serviço utilizando somente o terminal é necessário executar um comando no seguinte formato.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;nssm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;servicename&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;program&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arguments&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;servicename: É o nome que o serviço terá. Esse nome será utilizado para parar, iniciar dentre outras ações. É o identificador do serviço.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;program: É o programa que será executado. Alguns exemplos são python, node.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;arguments: Parâmetros que serão passados para o programa a ser executado. Pode-se passar o caminho de um &lt;strong&gt;&lt;em&gt;script&lt;/em&gt;&lt;/strong&gt; para um programa &lt;strong&gt;&lt;em&gt;python&lt;/em&gt;&lt;/strong&gt; por exemplo.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Para criar o serviço do servidor web simples escrito em &lt;strong&gt;&lt;em&gt;NodeJS&lt;/em&gt;&lt;/strong&gt; é necessário executar o comando trocando o valor de [caminho_para_index.js] para o caminho do seu arquivo index.js:&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;nssm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;exemplo_web_server&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;node&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;[caminho_para_index.js]&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No meu caso ficou:&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;nssm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;exemplo_web_server&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;node&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;C:\Users\thiagobaldino\Documents\index.js&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Esse comando irá criar um serviço com o nome &lt;strong&gt;“exemplo_web_server”&lt;/strong&gt;. Porém, o serviço ainda não foi inicializado. Na seção de testes será demonstrado como inicializar o serviço.&lt;/p&gt;

&lt;h3 id=&quot;instalação-de-um-serviço-utilizando-interface-gráfica&quot;&gt;Instalação de um serviço utilizando interface gráfica&lt;/h3&gt;

&lt;p&gt;Para instalar um serviço utilizando a interface gráfica deve-se, primeiramente, abrir o powershell executar o seguinte comando.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;nssm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Uma janela como mostrada na imagem abaixo irá aparecer. Os seguinter campos devem ser preenchidos:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Path: Caminho para a aplicação que será executada. Caso o executável esteja presente na variável &lt;strong&gt;&lt;em&gt;PATH&lt;/em&gt;&lt;/strong&gt; é possível somente escrever o nome da aplicação como &lt;strong&gt;&lt;em&gt;node&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Startup directory: Caminho em que o executavel irá ser executado.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Arguments: Os argumentos que serão passados ao executar a aplicação definida no campo &lt;em&gt;path&lt;/em&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Service name: Nome de identificação do serviço que deve ser único entre todos os serviços.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2023-09-21-criando_servicos_com_nssm/install_gui.png&quot; alt=&quot;install_gui.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Para criar o serviço para o servidor web acima deve-se colocar o valor “&lt;strong&gt;&lt;em&gt;node&lt;/em&gt;&lt;/strong&gt;” no campo &lt;strong&gt;&lt;em&gt;path&lt;/em&gt;&lt;/strong&gt;, o valor do caminho para o arquivo index.js no campo &lt;strong&gt;&lt;em&gt;arguments&lt;/em&gt;&lt;/strong&gt;. O campo startup directory pode ser deixado em branco.&lt;/p&gt;

&lt;p&gt;No meu caso, os campos ficaram com os seguintes valores:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Path: node&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Startup directory:&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Arguments: C:\Users\thiagobaldino\Documents\index.js&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Service name: exemplo_web_server&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;:warning: Caso o &lt;strong&gt;&lt;em&gt;NodeJS&lt;/em&gt;&lt;/strong&gt; não esteja presente na variável &lt;strong&gt;&lt;em&gt;PATH&lt;/em&gt;&lt;/strong&gt;, você terá que indicar o caminho completo no campo “&lt;em&gt;Path&lt;/em&gt;” para o binário do &lt;strong&gt;&lt;em&gt;NodeJS&lt;/em&gt;&lt;/strong&gt; ou a pasta que ele está presente no campo Startup directory.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Em seguida, para instalar, aperte no botão “&lt;strong&gt;install service&lt;/strong&gt;”. Porém, o serviço ainda não foi inicializado. Na seção de testes será demonstrado como inicializar o serviço.&lt;/p&gt;

&lt;h2 id=&quot;testando&quot;&gt;Testando&lt;/h2&gt;

&lt;p&gt;Para iniciar deve-se executar o seguinte comando:&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;nssm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;exemplo_web_server&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;O comando acima irá iniciar o serviço. Para conferir se o serviço está sendo executado pode-se abrir um navegador de internet e acessar o endereço &lt;strong&gt;http://localhost:8000&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2023-09-21-criando_servicos_com_nssm/api_response.png&quot; alt=&quot;api_response.png&quot; /&gt;&lt;/p&gt;

&lt;p&gt;O serviço também estará presente nas configurações de serviços do windows que pode ser acessada buscando “&lt;strong&gt;&lt;em&gt;services&lt;/em&gt;&lt;/strong&gt;” na busca de aplicativos do sistema.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2023-09-21-criando_servicos_com_nssm/services.png&quot; alt=&quot;services.png&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;bibliografia&quot;&gt;Bibliografia&lt;/h3&gt;

&lt;p&gt;1 - &lt;a href=&quot;https://wiki.archlinux.org/title/Systemd_(Portugu%C3%AAs)&quot;&gt;systemd (Português) - ArchWiki&lt;/a&gt;
2 - &lt;a href=&quot;[Controlling a Service Using SC - Win32 apps | Microsoft Learn](https://learn.microsoft.com/en-us/windows/win32/services/controlling-a-service-using-sc)&quot;&gt;sc - documentation&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;3 - &lt;a href=&quot;https://nssm.cc/&quot;&gt;nssm - site&lt;/a&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;4 - [Chocolatey Software&lt;/td&gt;
      &lt;td&gt;Installing Chocolatey](https://chocolatey.org/install#individual)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;5 - &lt;a href=&quot;https://en.wikipedia.org/wiki/PATH_(variable)&quot;&gt;PATH (variable) - Wikipedia&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;6 - &lt;a href=&quot;https://www.architectryan.com/2018/03/17/add-to-the-path-on-windows-10/&quot;&gt;Como adcionar uma pasta ao PATH&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;7 - &lt;a href=&quot;https://community.chocolatey.org/packages/nodejs.install&quot;&gt;choco nodejs.install&lt;/a&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;8 - [How To Create a Web Server in Node.js with the HTTP Module&lt;/td&gt;
      &lt;td&gt;DigitalOcean](https://www.digitalocean.com/community/tutorials/how-to-create-a-web-server-in-node-js-with-the-http-module)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;9 - &lt;a href=&quot;https://nssm.cc/commands&quot;&gt;NSSM - commands&lt;/a&gt;&lt;/p&gt;
</content>
 </entry>
 

</feed>
